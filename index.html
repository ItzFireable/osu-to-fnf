<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<style>
		@import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@500&display=swap');

		body {
			margin: 0;
		}

		* {
			font-family: 'Open Sans', sans-serif;
		}

		.content {
			padding: 18px 18px 0 18px;
			display: none;
			overflow: hidden;
			background-color: white;
		}

		.content-active {
			padding: 0 18px 0 18px;
			display: flex;
			justify-content: center;
		}

		.content a {
			display: inline-block;
			width: 150px;
			margin-bottom: 8px;
		}

		input [type="text"] {
			width: 200px;
		}
	</style>
</head>

<body>
	<script>
		var module = {}
		module.__exports = {}
		module.export = function (name, obj) {
			if (module.__exports[name] != null) {
				throw "export already exists::" + name
			}
			module.__exports[name] = obj
		}
		module.require = function (name) {
			if (module.__exports[name] == null) {
				throw "require cannot find::" + name
			}
			return module.__exports[name]
		}
	</script>
	<script src="curves.js"></script>
	<script src="slidercalc.js"></script>
	<script src="osuparser.js"></script>
	<script src="format.js"></script>
	<script src="osu_to_lua.js"></script>

	<script src="jquery.js"></script>
	<script>
		$(function () {
			$("#submit").click(function () {
				$("#out").val("converting...")
				var osu_file_str = $("#in").val()
				var options = {
					"bpm": $("#bpm").val(),
					"player2": $("#player2").val(),
					"player1": $("#player1").val(),
					"speed": $("#speed").val(),
					"needsvoices": document.getElementById("needsvoices").checked,
					"song": $("#song").val(),
					"onlyp1": document.getElementById("onlyp1").checked,
					"kiai": document.getElementById("addkiai").checked,
					"svs": document.getElementById("addsvs").checked,
					"convert": document.getElementById("convert").checked,
					"format": document.getElementById("autoformat").checked,
					"twoplayers": document.getElementById("twoplayers").checked,
				};
				$("#out").val(module.require("osu_to_lua")(osu_file_str, options))
			})
		})
	</script>
	<div class="content" style="display: block;">
		<a>Song:</a><input id="song" type="text" placeholder="Song name"> - The name of the song folder in assets
		(Defaults to song name in osu file or "songName" if none)<br />
		<a>Player1</a><input id="player1" type="text" placeholder="Player1"> - Player1's name (Defaults to "bf")<br />
		<a>Player2</a><input id="player2" type="text" placeholder="Player2"> - Player2's name (Defaults to "dad")<br />
		<a>BPM</a><input id="bpm" type="text" placeholder="BPM"> - BPM of the song (Defaults to max bpm in osu file or
		120 if none)<br />
		<a>Speed</a><input id="speed" type="text" placeholder="Speed"> - Note approach speed (Defaults to 1)<br />
		<a>Needs voices</a><input id="needsvoices" type="checkbox" placeholder="needsvoices"> - Does the song have a
		second file for voices (Defaults to false)<br />
		<a>Only player1</a><input id="onlyp1" type="checkbox" placeholder="onlyp1"> - All notes on player1's side
		(Defaults to false)<br />
		<a>Add kiai</a><input id="addkiai" type="checkbox" placeholder="addkiai"> - Add Kiai to chart events (Defaults to false)<br />
		<a>Add SVs</a><input id="addsvs" type="checkbox" placeholder="addsvs"> - Add SVs to chart events (Defaults to false)<br />
		<a>Convert to 2v2</a><input id="twoplayers" type="checkbox" placeholder="twoplayers"> - Converts chart to 2v2 using hitsounds (Defaults to false)<br />
		<a>4k to 8k</a><input id="convert" type="checkbox" placeholder="convert"> - Clone a 4k chart to both sides (Defaults to false, ONLY USE ON 4K CHARTS WITH ONLY PLAYER1 ENABLED)<br />
		<a>Auto format</a><input id="autoformat" type="checkbox" placeholder="autoformat"> - Automatically format your chart (Defaults to false)<br />
	</div>
	<br />
	<div class="content content-active">
		<textarea id="in" style="width:49.5%;height:200px;margin-right:0.5%;" placeholder="paste contents of osu file here"></textarea>
		<textarea id="out" style="width:49.5%;height:200px;margin-left:0.5%;" readonly>output (paste this into the JSON file with the correct name)</textarea>
	</div>
	<div class="content content-active" style="padding: 18px 18px 0 18px !important">
		<button id="submit">Convert</button>
	</div>


	<script>
		var coll = document.getElementsByClassName("collapsible");
		var i;

		for (i = 0; i < coll.length; i++) {
			coll[i].addEventListener("click", function () {
				this.classList.toggle("active");
				var content = this.nextElementSibling;
				if (content.style.display === "block") {
					content.style.display = "none";
					this.children[0].innerHTML = this.value + "∨"
				} else {
					content.style.display = "block";
					this.children[0].innerHTML = this.value + "∧"
				}
			});
		}
	</script>
</body>

</html>